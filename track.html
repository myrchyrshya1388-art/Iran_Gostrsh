<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ø³ÙØ§Ø±Ø´</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      background: #f3f4f6;
      font-family: sans-serif;
    }
    .track-box {
      max-width: 420px;
      margin: 60px auto;
      background: #fff;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    .track-box h2 {
      text-align: center;
      margin-bottom: 15px;
    }
    .track-box input {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #ccc;
      margin-bottom: 10px;
      font-size: 14px;
    }
    .track-box button {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 12px;
      background: #2563eb;
      color: #1a1919;
      font-size: 15px;
      cursor: pointer;
    }
    .track-result {
      margin-top: 15px;
      font-size: 14px;
      line-height: 1.8;
      color: #111827;
    }
    .error {
      color: #dc2626;
    }
    ul {
      padding-right: 18px;
    }
  </style>
</head>
<body>

<div class="track-box">
  <h2>ğŸ“¦ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ø³ÙØ§Ø±Ø´</h2>

  <input
    type="text"
    id="trackInput"
    placeholder="Ú©Ø¯ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ (Ù…Ø«Ø§Ù„: ORD-123456)"
  >

  <button type="button" onclick="trackOrder()">Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´</button>

  <div id="trackResult" class="track-result"></div>
</div>

<script>
function trackOrder() {
  const code = document.getElementById("trackInput").value.trim();
  const result = document.getElementById("trackResult");

  if (!code) {
    result.innerHTML = "<div class='error'>âŒ Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</div>";
    return;
  }

  // Ù‡Ù…Ù‡ Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§
  const orders = JSON.parse(localStorage.getItem("orders")) || [];

  // Ø¢Ø®Ø±ÛŒÙ† Ø³ÙØ§Ø±Ø´
  const lastOrder = JSON.parse(localStorage.getItem("lastOrder"));

  let order = orders.find(o => o.trackingCode === code);

  // Ø§Ú¯Ø± Ø¯Ø§Ø®Ù„ orders Ù†Ø¨ÙˆØ¯ØŒ lastOrder Ø±Ø§ Ú†Ú© Ú©Ù†
  if (!order && lastOrder && lastOrder.trackingCode === code) {
    order = lastOrder;
  }

  if (!order) {
    result.innerHTML = "<div class='error'>âŒ Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ø§ Ø§ÛŒÙ† Ú©Ø¯ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</div>";
    return;
  }

  // Ø²Ù…Ø§Ù†
  let dateStr = "-";
let timeStr = "-";
let dayStr  = "-";

if (order.createdAt) {
  const date = new Date(order.createdAt);

  if (!isNaN(date)) {
    dateStr = date.toLocaleDateString("fa-IR");
    timeStr = date.toLocaleTimeString("fa-IR", {
      hour: "2-digit",
      minute: "2-digit"
    });
    dayStr = date.toLocaleDateString("fa-IR", { weekday: "long"Â });
}
}
 

  // Ù…Ø­ØµÙˆÙ„Ø§Øª
  let itemsHTML = "";
  let items = order.items;

  // Ø§Ú¯Ø± Ø¨Ù‡â€ŒØ§Ø´ØªØ¨Ø§Ù‡ Ø¢ÛŒØªÙ… ØªÚ©ÛŒ Ø¨ÙˆØ¯
  if (!Array.isArray(items)) {
    items = [items];
  }

  items.forEach(item => {
    itemsHTML += `<li>${item.name} Ã— ${item.qty}</li>`;
  });

  result.innerHTML = `
    <h3>ğŸ“‹ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÙØ§Ø±Ø´</h3>
    <p><strong>Ú©Ø¯ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ:</strong> ${order.trackingCode}</p>
    <p><strong>ÙˆØ¶Ø¹ÛŒØª:</strong> ${order.status}</p>
    <p><strong>ØªØ§Ø±ÛŒØ®:</strong> ${dateStr}</p>
    <p><strong>Ø±ÙˆØ²:</strong> ${dayStr}</p>
    <p><strong>Ø³Ø§Ø¹Øª:</strong> ${timeStr}</p>
    <hr>
    <h4>ğŸ›’ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø³ÙØ§Ø±Ø´:</h4>
    <ul>${itemsHTML}</ul>
  `;
}
</script>

</body>
</html>